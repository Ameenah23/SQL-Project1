Question 1: 

SQL Queries:
SELECT DISTINCT productsku, visitid, fullvisitorid, COUNT(*) 
FROM all_sessions
GROUP BY productsku, visitid, fullvisitorid
HAVING(COUNT(*)>1);

SELECT *
, ROW_NUMBER() OVER (PARTITION BY productsku, visitid) as rn
FROM all_sessions


SELECT * FROM(
	SELECT*
	, ROW_NUMBER() OVER (PARTITION BY productsku, visitid) as rn
	FROM all_sessions) x
WHERE x.rn>1;	


Answer: 
Some of columns that contain duplicate records
productsku
visitid
fullvisitorid




Question 2: 

SQL Queries:
SELECT COUNT(fullvisitorid) 
FROM all_sessions

Answer:

total number of unique visitors (`fullVisitorID`)= 14873

Question 3: 

SQL Queries:
SELECT COUNT(visitid) 
FROM all_sessions

Answer:

total number of unique visitors (`visitid`)= 14873

Question 4: 

SQL Queries:

SELECT visitid, total_ordered, COUNT(*)
FROM all_sessions aa
JOIN sale_report bb
	ON aa.productsku=bb.productsku 
GROUP BY visitid, total_ordered
HAVING visitid > 1
LIMIT 10;

Answer:
visitid	total_ordered	count
1496949281	1	1
1470268175	43	1
1472109793	11	1
1496567631	30	1
1470868446	3	1
1481730283	50	1
1494337059	2	1
1474204584	9	1
1489308957	85	1
1487804892	50	1



Question 5: 

SQL Queries:

WITH t1 AS 
 (SELECT visitid, productprice, Count(*) AS n 
  FROM all_sessions
  GROUP BY visitid, productprice)
SELECT visitid, productprice, n, 
       (0.0+n)/(COUNT(*) OVER (PARTITION BY visitid)) as percentage-- no integer divide!
FROM t1;

Answer:

Some of the data
visitid	productprice	n	percentage
1470037277	3990000	1	1
1470040969	3500000	1	1
1470042235	20990000	1	0.5
1470042235	16990000	1	0.5
1470046384	55990000	1	1
1470050586	16990000	1	1
1470051098	16990000	1	1
1470057334	16990000	1	1
1470063289	16990000	1	1
1470063888	16990000	1	1
1470064191	15190000	1	1
1470066086	16990000	1	1
1470070230	12990000	1	1
1470072170	20990000	1	1
1470074964	4990000	1	1
1470075169	54990000	1	1
1470079986	16990000	1	1
1470080149	3990000	1	1
1470080791	33990000	1	1
1470081283	4990000	1	1
1470081685	1590000	1	1
1470081945	1500000	1	1
1470083175	0	1	1
1470083542	19990000	1	1
1470085237	55990000	1	1
1470089841	20990000	1	1
1470092800	3990000	1	1
1470093166	5990000	1	0.5
1470093166	18990000	1	0.5
1470094037	18990000	1	1
1470094150	7990000	1	1
1470094419	10390000	1	1
1470094849	20990000	1	1
1470099835	16990000	1	1
1470109020	12990000	1	1
1470112197	16990000	1	1
1470113824	16990000	1	1
1470114566	15190000	1	1
1470121149	1590000	1	1
1470124655	139990000	1	1
1470126740	3990000	1	1
1470130830	55990000	1	1
1470131218	3500000	1	1
1470132453	74990000	1	1
1470133698	18990000	1	1
1470135744	2990000	1	1
1470139835	16990000	1	1
1470143051	16990000	1	1
1470144421	19190000	1	1
1470147045	16990000	1	1
1470148030	20990000	1	1
1470148773	16990000	1	1
1470148819	16990000	1	1
1470149248	98990000	1	1
1470152438	99990000	1	0.5
1470152438	21990000	1	0.5
1470152791	18990000	1	1
1470152925	12990000	1	1
1470153167	1250000	1	1
1470154525	59990000	1	1
1470155489	21990000	1	1
1470156420	21990000	1	1
1470157174	16990000	1	1
1470157307	21990000	1	0.5
1470157307	20990000	1	0.5
1470158497	16990000	1	1
1470159157	14390000	1	1
1470160056	16990000	1	1
1470160108	9990000	1	1
1470161021	16990000	1	1
1470162542	20990000	1	1
1470163327	37990000	1	1
1470164381	109990000	1	1
1470164594	16990000	1	1
1470166536	16990000	1	1
1470168046	46390000	1	1
1470168645	69990000	1	1
1470168910	12990000	1	1
1470168941	43990000	1	1
1470169912	16990000	1	1
1470170387	16990000	1	1
1470170741	18990000	1	1
1470171312	12990000	1	1
1470171352	24790000	1	1
1470172116	1990000	1	1
1470172144	36990000	1	1
1470174905	2500000	1	0.5
1470174905	1990000	1	0.5
1470175459	17990000	1	1
1470176763	5990000	1	1
1470180987	43990000	1	1
1470188849	16990000	1	1
1470188876	5990000	1	1
1470190070	74990000	1	1
1470190103	89990000	1	1
1470191770	4990000	1	1
1470192164	104990000	1	1
1470195148	16990000	1	1
1470196160	16990000	1	1
1470197101	24990000	1	1
1470197482	24990000	1	1
1470204229	63990000	1	1
1470205292	16990000	1	1
1470207633	55990000	1	1
1470209115	98990000	1	1
1470213646	13990000	1	1
1470213878	3990000	1	1
1470218713	16990000	1	1
1470219068	4990000	1	1
1470222606	4990000	1	0.5
1470222606	16990000	1	0.5
1470223630	21990000	1	1
1470225812	24990000	1	1
1470227436	20990000	1	1
1470232287	22990000	1	1
1470232855	1250000	1	1
1470236710	3500000	1	1
1470237065	16990000	1	1
1470237190	9990000	1	1
1470239143	4990000	1	1
1470240014	18990000	1	1
1470240879	16990000	1	1
1470242176	37990000	1	1
1470242320	74990000	1	1
1470243449	16990000	1	1
1470243712	17590000	1	1
1470246970	24990000	1	1
1470249298	12990000	1	1
1470249777	21990000	1	1
1470250539	4990000	1	0.5
1470250539	18990000	1	0.5
1470250837	1590000	1	1
1470251193	37990000	1	1
1470252107	16990000	1	1
1470252486	55990000	1	1
1470253615	21990000	1	1
1470253915	1500000	1	1
